#  iris-angular

This project was generated with [Angular CLI](https://github.com/angular/angular-cli)
And use restful-api with csrf-token security check to [IRIS(go framework](https://iris-go.com/)
這個專案由[Angular CLI](https://github.com/angular/angular-cli)建立
並以restful-api的方式串接[IRIS(go的web框架)](https://iris-go.com/)附帶csrf-token驗證

## What it contains? 這個專案包含什麼？

* files generated with angular cli
* a iris go server
* some angular servies which work with go
* 由angular cli產生的檔案
* 一個iris go伺服
* 一些與go 串接用的angular servies

## Project structure 專案結構

```bash
$ tree
.
├── dist
├── main.go
├── sqlite3.db
├── src
│   ├── app
│   │   ├── app-routing.module.ts
│   │   ├── app.component.css
│   │   ├── app.component.html
│   │   ├── app.component.spec.ts
│   │   ├── app.component.ts
│   │   ├── app.module.ts
│   │   ├── backend.service.ts
│   │   ├── home
│   │   │   ├── home.component.css
│   │   │   ├── home.component.html
│   │   │   ├── home.component.spec.ts
│   │   │   └── home.component.ts
│   │   ├── message.service.ts
│   │   ├── message.ts
│   │   └── page-not-found
│   │       ├── page-not-found.component.css
│   │       ├── page-not-found.component.html
│   │       ├── page-not-found.component.spec.ts
│   │       └── page-not-found.component.ts
│   ├── assets
│   ├── favicon.ico
│   ├── index.html
│   ├── main.ts
```
**Warning**: that isn't the full structure,

**注意**: 上面的不是完整結構

### Explain

* Most of files are generated by angular-cli
* main.go <- The only file of go-iris.
* sqlite3.db <- The database file which created by XORM in main.go

* ↓iris will find those files below.
* dist <- The webpacked html, css, javascript files generated by ng build command.
* index.html <- Where csrf-token inject and the main entry of front-end.
* assets <- The default dictionary of external files, can changed in ng-cli's setting.
* ↑
 
* src/app/app.module.ts <- Main setting of the whole angular's project, example: csrftoken's name in header.
* src/app/app-routing.module.ts <- Will handler the router of front-end.
* src/app/home <- The example post form component.
* src/app/page-not-found <- The example wildcard component.
* src/app/message.service.ts <- The party of apis of the message service.
* src/app/backend.service.ts <- The core function handle the request with iris. Set the csrf header.

### 說明

* 大部份的檔案由angular-cli產生
* main.go <- iris伺服的主檔案
* sqlite3.db <- 由go的XORM產生的db檔

* ↓iris 會尋找以下位置的檔案
* dist <- 由ng-build產生，webpack打包好的html, css, js
* index.html <- 前端的進入點，csrftoken注入的檔案
* assets <- 會被尋找的外部靜檔案們, 可在ng-cli改變路徑
* ↑

* src/app/app.module.ts <- angular專案的主設定檔, 如：csrftoken在header中的名稱
* src/app/app-routing.module.ts <- 前端負責的routers
* src/app/home <- 一個範例的post表單component
* src/app/page-not-found <- 當找不到頁面時顯示的導向component
* src/app/message.service.ts <- message service會使用的api
* src/app/backend.service.ts <- 與iris溝通的核心程式，如設定csrf

## Install 安裝

* Clone the repo:
* Clone 這個專案

```
$git clone https://github.com/douasin/iris-angular.git
$cd iris-angular
```

* Install angular-cli:
* (npm is required. Check the angular-cli pages(https://github.com/angular/angular-cil) for better information)
* 安裝angular-cli
* (需要npm, 最好去angular-cli的頁面取得最佳資訊)
```
$npm install -g @angular/cli
$npm build
```

* Install iris and XORM's packages and dependencies:
* 安裝iris跟XORM的套件及其相依
```
$go get -u github.com/kataras/iris
$go get -u github.com/mattn/go-sqlite3
$go get -u github.com/go-xorm/xorm
```

## Run Server 啟動伺服

* Webpack the files to dist.
* (use ng build --prod for production with better size but taking more time)
* 打包檔案
* (在生產環境使用ng build --prod 取得更好的壓縮率，但花比較多時間打包)
```
$ng build
```

* Start Iris
* (Of couse you can go build it first)
* 啟動Iris
* (可以先用go bulid 編譯)
```
$go run main.go
```

* that's it. Open http://localhost:8080(if you use default port) at your browser.
* be sure to check [IRIS](https://iris-go.com) and [angular-cli](https://github.com/angular/angular/cli)

* [My web site 我的網站](https://douasin.com)
